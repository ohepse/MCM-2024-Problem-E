### 模型假设

你可以坚持用简单的指数模型 $\lambda(t) = \lambda_0 e^{kt}$，但是**必须加一个限制条件**。

**操作手法：**

在论文的“模型假设 (Assumptions)”部分明确写出：

> "我们的模型适用于短期预测（Short-term Projection），即未来 10-20 年。我们假设在这段时期内，气候临界点尚未到来，灾害频率尚未达到饱和。"

题目提到气候变化会导致保费在 2040 年前增加 30-60% 。这暗示了题目关注的时间跨度大约是未来 15-20 年。在这个尺度下，指数增长还没有飞到天上去，是可以接受的。



---

### 3. 数据处理与案例选择 (Data Processing and Case Selection)

为了确保“动态保险承保模型”的可靠性与适用性，我们制定了一套严谨的数据处理流程，涵盖数据获取、特征筛选、异常值处理及多维数据集重构。

#### 3.1 数据来源与范围 (Data Source and Scope)

本文选用 **EM-DAT (The International Disaster Database)** 作为核心数据源。该数据库由比利时鲁汶大学灾害流行病学研究中心（CRED）维护，是全球公认的最权威的灾害统计数据库。

- **时间跨度：** 我们选取 **1990年至2024年** 作为研究的时间窗口。这35年的数据既能充分捕捉现代气候变化的加速趋势，又避免了早期历史数据记录不全导致的统计偏差。
- **灾害筛选：** 鉴于题目聚焦于气候风险，我们严格剔除了地震、火山爆发等地质灾害（Geophysical events）。数据筛选专注于与气候变化强相关的六大类灾害：**风暴 (Storms)、洪水 (Floods)、野火 (Wildfires)、干旱 (Droughts)、极端气温 (Extreme Temperatures) 及 湿润性滑坡 (Wet Mass Movements)**。

#### 3.2 案例选择策略：最大差异化原则 (Case Selection Strategy)

为了验证模型在不同经济体和风险环境下的鲁棒性，本文依据 **“最大差异化原则” (Principle of Maximum Divergence)** 选取了两个位于不同大洲、具有截然不同经济特征的典型区域进行对比研究：

1. **案例 A：美国德克萨斯州 (Texas, USA) —— 北美洲**
   - **代表性：** 代表**“高收入、高资产暴露”**的发达地区。
   - **特征：** 德州拥有极高的房地产价值和成熟的保险市场（保险覆盖率约为 50%），但频繁遭受飓风（如 Harvey, Ike）和极端寒潮的袭击。其主要矛盾在于气候恶化导致的**保费支付能力危机 (Affordability Crisis)**。
2. **案例 B：菲律宾吕宋岛 (Luzon, Philippines) —— 亚洲**
   - **代表性：** 代表**“发展中、高脆弱性”**的地区。
   - **特征：** 作为群岛国家的经济中心，吕宋岛位于台风带，灾害频发。然而，该地区面临严重的**“保险保护缺口” (Insurance Protection Gap)**，保险覆盖率极低（约 10%）。其主要矛盾在于保险市场的**生存可行性 (Market Viability)**。

#### 3.3 数据清洗与重构 (Data Cleaning and Structuring)

利用 Python (Pandas 库)，我们对原始数据进行了以下预处理步骤，以消除噪声并适配模型输入：

1. **缺失值处理 (Handling Missing Values)：** 对于无灾害记录的年份，我们将频次填充为 0，以保证时间序列的连续性，满足 NHPP 模型的训练需求。
2. **通胀调整 (Inflation Adjustment)：** 为消除货币时间价值的影响，我们统一采用 EM-DAT 中的 **"Total Damage, Adjusted"** 字段。该字段基于消费者价格指数 (CPI) 将历史损失折算为 **2024年美元现值**，确保了跨时期经济损失的可比性。
3. **多维数据集重构 (Structuring)：** 我们将非结构化的原始清单重构为三个耦合矩阵，分别服务于模型的不同模块：
   - **频率矩阵 (Frequency Matrix):** 记录年度灾害发生次数，用于拟合气候恶化因子 $k$。
   - **损失矩阵 (Severity Matrix):** 记录单次事件的经济损失，用于构建易损性曲线。
   - **经济矩阵 (Economic Matrix):** 基于区域 GDP 增长率重构居民收入数据，用于界定保费支付上限 $P_{max}$。



## 第一阶段：核心模型构建——保险承保模型 (Q1)

**任务**：建立一个决策模型，判断保险公司在什么情况下应该承保（Underwrite），什么情况下应该拒绝。

### 1. 定义核心变量（量化风险）

首先，你们需要用数学语言描述“危机”。

- **$P(t)$**：极端天气在 $t$ 时刻发生的概率。
  
  - $$P(X=k) = \frac{\lambda^k e^{-\lambda}}{k!}$$
  
    - $X$: 一年内发生的灾害次数。
    - $k$: 具体的次数 (0, 1, 2...)。
    - $\lambda$: 平均发生率 (比如过去10年平均每年发生0.5次)。
  
  - 非齐次泊松分布（NHPP）：
  
    * **痛点：** 传统的泊松分布假设 $\lambda$ 是常数。但题目明确指出“气候变化导致灾害增加” 。如果 $\lambda$ 不变，你们的模型就无法反映未来风险的上升。
  
    * **改进：** 使用 **非齐次泊松过程 (NHPP)**。 我们要让 $\lambda$ 变成时间 $t$ 的函数：$\lambda(t)$。
  
    * $\lambda(t)=ae^{kt}$
  
    * 当 $\lambda(t)$ 超过某个临界值（比如一年发生 3 次大灾害），保费就会贵到没人买得起，或者赔付额超过了保险公司的总资产。
  
      **结论：** 并不是 $\lambda(t)$ 不会变大，而是当 $\lambda(t) > \text{Threshold}$ 时，**你的模型输出结果是“拒绝承保 (Do Not Underwrite)”**。
  
      $$\text{Decision}(t) = \begin{cases}  \text{Underwrite}, & \text{if } \lambda(t) < \lambda_{critical} \\ \text{Withdraw}, & \text{if } \lambda(t) \ge \lambda_{critical} \end{cases}$$
  
- **$L$**：单次灾害造成的经济损失（Loss）。

  * 保险公司关心的通常不是“某一年”，而是“未来10年的总赔付”。这就需要把 NHPP 的连续特性用积分表达出来。

    **核心逻辑：**

    我们在时间段 $[0, T]$ 内的**总预期累积损失**。

    **数学公式：**

    $$\text{Total Loss} = \int_{0}^{T} \lambda(t) \cdot \mu_L(t) \, dt$$

    - $\lambda(t) = \lambda_0 e^{kt}$: 灾害发生的瞬时速率（来自 NHPP）。
    - $\mu_L(t) = L_0 (1+g)^t$: 单次灾害的平均成本（考虑了 $g$ 通货膨胀率或房产增值）。

    **推导结果 (可以直接用在论文里)：**

    将两个指数函数相乘 $\lambda(t) \cdot \mu_L(t) = (\lambda_0 L_0) e^{(k+g)t}$，积分后得：

    $$\text{Total Loss} = \frac{\lambda_0 L_0}{k+g} \left( e^{(k+g)T} - 1 \right)$$

    **亮点：** 这个公式非常漂亮地展示了 **气候因子 ($k$)** 和 **经济因子 ($g$)** 是如何共同作用，加速风险累积的。

- $$E[N]_{t_1 \to t_2} = \int_{t_1}^{t_2} \lambda_0 e^{kt} \, dt = \frac{\lambda_0}{k} (e^{kt_2} - e^{kt_1})$$

  **这个结果可以直接代入你们的“总损失模型”：**

  $$\text{Total Expected Loss} = E[N]_{t_1 \to t_2} \times \text{平均单次损失}$$ 长期指标，决定公司需要储备多少储备金才能不破产

  $$\text{Annual Expected Loss}(t) = \lambda(t) \cdot \mu_L(t) = \lambda_0 L_0 e^{(k+g)t}$$ 决定当年的保费

### 2. 建立决策不等式（保险公司的底线）

我们要建立一个不等式。只有当这个不等式成立时，保险系统才是“可持续”的。

#### 1. 定义保险公司的“保费底线” (Minimum Viable Premium, $P_{min}$)

保险公司收取的保费必须覆盖预期赔付加上运营利润。

根据之前的推导，第 $t$ 年的预期赔付是 $\lambda(t) \cdot E[L_t]$。

$$P_{min}(t) = (1 + \rho) \cdot \underbrace{\lambda(t)}_{\text{NHPP频率}} \cdot \underbrace{V_t \cdot D(I)}_{\text{预期损失}}$$

- $\rho$: 目标利润率及运营成本系数 (例如 20%)。
- $\lambda(t) = \lambda_0 e^{kt}$: 气候变化导致的灾害频率。
- $V_t$: 房产价值。
- $D(I)$: 易损性（破坏率）。

#### 2. 定义业主的“支付上限” (Maximum Affordable Premium, $P_{max}$)

房主能掏多少钱是有限的。通常认为保费不能超过家庭年收入的一定比例（如 5%）。

$$P_{max}(t) = \alpha \cdot \text{Income}(t)$$

- $\alpha$: 负担能力系数 (Affordability Ratio)。
- $\text{Income}(t)$: 当地居民的平均年收入（随GDP增长）。

#### 3. 承保的充要条件 (The Decision Rule)

保险公司应当承保，**当且仅当**：

$$P_{min}(t) \le P_{max}(t)$$

展开后即为核心判据：

$$(1 + \rho) \cdot \lambda_0 e^{kt} \cdot V_0 (1+g)^t \cdot D(I) \le \alpha \cdot \text{Income}_0 (1+g_{inc})^t$$

### 3. 引入“偿付能力”概念（Ruin Probability）

如果一次特大灾害导致赔付超过了公司现有的现金流，公司就破产了。

- *AI/模拟应用*：这里可以用简单的**蒙特卡洛模拟 (Monte Carlo)**。模拟 10,000 次未来的天气情景，看有多少次导致公司破产。如果破产率 > 5%，则该地区“不可承保”。

单纯满足上述不等式只是“能做”。要回答“何时该主动做”，需要引入**风险控制视角**。

保险公司应在满足 **偿付能力约束 (Solvency Constraint)** 的前提下主动承担风险。即：即便发生概率极低的大灾难（比如“百年一遇”），公司也不能破产。

**数学表达：**

保险公司应在以下条件成立时主动承保：

$$\text{Capital} + \text{Premiums} > \text{VaR}_{99.5\%}(\text{Total Loss})$$

- **VaR (Value at Risk):** 通过蒙特卡洛模拟算出的、在 99.5% 的极端情况下可能发生的最大损失。
- **含义：** 只有当公司持有的准备金足以抵御“黑天鹅”事件时，这种风险才是**“可计算的风险”**，而非赌博。此时，承保是理性的商业行为。

### 4. 业主能否通过自身行为影响这一决策？(Impact of Property Owners)

**答案是肯定的。** 这也是题目中“Preservation Model”的伏笔。

业主可以通过**“防灾减灾行为” (Mitigation Measures)** 直接改变模型参数，从而把“不可保”变为“可保”。

#### 1. 引入“减灾因子” $\eta$ (Mitigation Factor)

假设业主采取了加固屋顶、抬高地基等措施。这将直接降低**易损性函数 $D(I)$**。

修正后的损失模型：

$$L'_{event} = L_{event} \cdot (1 - \eta)$$

- $\eta$: 减灾效率 ($0 \le \eta < 1$)。

#### 2. 反馈机制 (Feedback Loop)

业主的行为会使不等式左边的 $P_{min}$ 下降：

$$P'_{min}(t) = (1 + \rho) \cdot \lambda(t) \cdot [V_t \cdot D(I) \cdot (1 - \eta)]$$

**结论：**

如果 $P_{min}(t) > P_{max}(t)$ （原定不承保），但业主投入 $\eta$ 的努力后，使得 $P'_{min}(t) \le P_{max}(t)$，那么保险公司就会**改变决策，同意承保**。

------

## 第二阶段：保险承保模型的双重验证

### (Solution to Task 2: Dual-Case Simulation and Intervention Analysis)

基于问题一构建的“动态保险承保模型”，我们选取了 **美国得克萨斯州 (Texas)** 和 **菲律宾吕宋岛 (Luzon)** 作为案例对象。本节将通过数值模拟求解两个关键问题：(1) 在现状下保险市场何时崩溃？(2) 业主采取减灾措施能否推迟这一崩溃点？

#### 5.1 求解算法与参数初始化 (Algorithm and Initialization)

为了求解市场崩溃时间点 $t_{fail}$，我们采用 **逐年迭代法 (Year-by-Year Iteration)**。我们定义 $t_{fail}$ 为满足条件 $P_{min}(t) > P_{max}(t)$ 的最小年份。

求解流程分为以下三个步骤：

1. **参数校准 (Calibration)：**

   根据 EM-DAT 历史数据拟合出两地的气候恶化因子 $k$，并根据当地经济数据设定初始负担率 $\beta_0$ 和保险覆盖率 $\eta_{cov}$。

   - **Texas:** $k \approx 1.2\%$ , $\eta_{cov}=50\%$ (高覆盖), $\beta_0=0.6$。
   - **Luzon:** $k \approx 4.5\%$ , $\eta_{cov}=10\%$ (低覆盖), $\beta_0=0.45$。

2. **基准情景计算 (Baseline Calculation)：**

   计算未采取任何干预措施下的风险成本曲线 $P_{min}(t)$ 和 支付能力上限曲线 $P_{max}(t)$，寻找两条曲线的第一交点，记为 $T_{original}$。

3. **干预情景计算 (Mitigation Calculation)：**

   引入“文物保护与减灾因子” $\mu$ (设为 $0.20$)。减灾后的风险成本函数修正为：

   $$P_{mitigated}(t) = P_{min}(t) \times (1 - \mu)$$

   重新寻找 $P_{mitigated}(t)$ 与 $P_{max}(t)$ 的交点，记为 $T_{mitigated}$。

#### 5.2 基础情景求解结果 (Baseline Scenario Results)

我们将数据代入模型进行迭代求解，得到两地在“无干预”状态下的市场生存周期（如图 5 红色曲线所示）：

- **案例 A：Texas (2048年崩溃)**

  求解显示，由于得州的高资产暴露和高保险覆盖率，风险成本随气候恶化呈指数级攀升。尽管当地经济增长强劲，但在 **2048年**，保费成本首次击穿居民支付能力上限。这标志着保险公司若不退出市场或大幅提价，将面临偿付危机。

- **案例 B：Luzon (2057年崩溃)**

  求解结果显示 Luzon 的崩溃时间为 **2057年**。这一较晚的年份并非源于低风险，而是源于极低的保险覆盖率 (10%) 掩盖了真实的赔付压力。市场处于一种“低水平的脆弱平衡”中。

#### 5.3 减灾干预的求解分析 (Analysis of Mitigation Intervention)

为了评估业主行为的影响，我们模拟了业主采取防灾措施（如加固地基、安装防风设施）的情景。模型假设这些措施能降低 20% 的预期损失。

求解结果（如图 5 绿色曲线所示）表明：

- **成本曲线下移：** 减灾措施使得风险成本曲线显著下移，扩大了其与支付上限曲线之间的“安全空间”。
- **生存期延长 (Time Gained)：**
  - 在 **Texas**，崩溃点从 2048 年推迟至 **2050年代后期**，成功争取了约 **10年** 的市场稳定期。
  - 在 **Luzon**，减灾措施同样推迟了崩溃点，进一步证明了降低易损性对于延长保险市场寿命的有效性。

#### 5.4 求解结论 (Conclusion of Solution)

通过双案例求解，我们得出明确结论：

1. **崩溃不可避免：** 在气候恶化 ($k>0$) 的大背景下，无论发达还是发展中地区，保险市场最终都会在未来 30-40 年内面临“不可保”的临界点。
2. **干预有效：** 业主的减灾行为可以显著改变模型输出，将市场崩溃时间推后。这证明了保险公司应当将 **“要求业主采取保护措施”** 作为承保的必要条件。

------

### 第三阶段：反向应用——城市规划/房地产模型 (Q3)

**任务**：视角反转。如果你是开发商或市长，根据保险模型的结论，决定**哪里建**、**怎么建**。

#### 1. 建立优化目标函数

这是一个经典的**最优化问题 (Optimization Problem)**。

目标：最小化“全生命周期成本” (Total Cost of Ownership)。

$$Z(h) = \underbrace{C_{build}(h)}_{\text{初始建设}} + \underbrace{\sum_{t=1}^{T} \left( P_{min}(t, h) + E[L_{gap}](t, h) \right)}_{\text{未来T年的总运营与风险成本}}$$

- $C_{\text{build}}(h)$,$C_{build}(h) = V_{base} (1 + \beta h^2)$建设成本
- $P_{min}(t,h)$：根据第一阶段模型算出的未来 30 年保费总和。
- $C_{\text{residual\_risk}}$：保险不赔的部分（自付额）。

#### 2. 微积分求极值

- 假设 $h$ 是是建筑加固的等级。

- **未来风险成本流 (年化)：**

  $$Cost(t, h) \approx \underbrace{(1+\rho)}_{\text{保险加成}} \cdot \underbrace{\lambda_0 e^{kt}}_{\text{气候风险}} \cdot \underbrace{V_{base}(1+\beta h^2)(1+g)^t}_{\text{资产价值}} \cdot \underbrace{D_{max} e^{-\gamma h}}_{\text{易损性}}$$

- 令常数集合 $A = (1+\rho) \lambda_0 V_{base} D_{max}$，合并时间指数项 $K = k + g$（气候恶化率 + 资产增值率）。

  未来总风险成本（积分形式）：

  $$Total\_Risk(h) = \int_{0}^{T} Cost(t, h) dt = A (1+\beta h^2) e^{-\gamma h} \cdot \int_{0}^{T} e^{Kt} dt$$

  积分项 $\int_{0}^{T} e^{Kt} dt = \frac{e^{KT} - 1}{K}$，我们将这一大坨常数记为 $\Omega$（代表时间累积因子）。

  **最终简化的总成本模型：**

  $$Z(h) = V_{base}(1 + \beta h^2) + \underbrace{A \cdot \Omega \cdot (1 + \beta h^2) e^{-\gamma h}}_{\text{全周期风险成本}}$$

  其中： $\Omega = \frac{e^{(k+g)T} - 1}{k+g}$ 

- **求解**：找到 $\frac{dZ}{dh} = 0$ 的点。这个点就是“最佳建筑标准”。如果算出的最佳成本太高，结论就是“不建议在此地建设”。

- 开发可行性判定模型


  $F = \frac{Z(h^*)}{P}$

  其中：

  • $P$ 为项目预期总收益；

  • $F \leq 1$ 判定适宜开发，$$F > 1$$ 判定不适宜开发。

------

### 第四阶段：特殊价值评估——文物保护模型 (Q4)

**任务**：如果建筑物有文化价值（如古迹），怎么决定保不保？

#### 1. 量化“无形价值” (Intangible Value)

普通的保险模型只看钱（重建成本）。文物不能重建。

你需要引入一个新的变量 $V_{culture}$。

- **评分卡模型 (Scorecard)**：建立一个指标体系（历史年份、稀缺度、游客量、象征意义），用线性代数里的**加权求和**算出文化得分。

#### 2. 修改决策逻辑

新的决策逻辑不再纯粹看利润，而是看“性价比”：

$$\text{Preservation Ratio} = \frac{\text{Cultural Value} + \text{Economic Value}}{\text{Cost of Protection}}$$

- 如果比值 > 1，即使亏本也要保护（可能需要政府补贴，而不是纯商业保险）。

#### 3. 详细过程

#### 第一步：量化文化价值 (Cultural Value Quantification)

我们使用**加权综合评价法 (Weighted Linear Combination)** 来计算文化价值指数。

$$V_{culture} = \sum_{i=1}^{n} w_i \cdot S_i$$

其中：

- $n$ 是评价维度的数量（如：历史、艺术、社会象征）。
- $S_i$ 是第 $i$ 个维度的归一化得分（$0 \le S_i \le 100$）。
- $w_i$ 是第 $i$ 个维度的权重，满足 $\sum_{i=1}^{n} w_i = 1$。

**权重 $w_i$ 的确定：**

为了体现数学深度，建议在论文中简要说明使用 **熵权法 (Entropy Weight Method)** 或 **AHP** 确定权重。公式如下（以熵权法为例）：

$$w_i = \frac{1 - H_i}{n - \sum_{j=1}^{n} H_j}$$

(其中 $H_i$ 是第 $i$ 个指标的信息熵，这表明数据越离散，该指标提供的信息量越大，权重越高。)

#### 第二步：价值整合与货币化 (Value Integration)

普通的商业模型只看 $V_{econ}$，我们的“保护模型”看的是**广义总价值 ($TV$)**：

$$TV = V_{econ} + \alpha \cdot V_{culture}$$

- $V_{econ} = V_{property} + \sum_{t=1}^{T} \frac{R_t}{(1+r)^t}$
  - $V_{property}$: 不动产当前市场残值。
  - 第二项: 未来 $T$ 年旅游/商业收入 $R_t$ 的净现值 (NPV)。
- $\alpha$: **影子价格 (Shadow Price)**。这代表社会愿意为保护 1 个单位的文化评分支付多少美元。你可以设定为当地人均GDP的一个百分比，或者假设它是一个待定参数。

#### 第三步：成本风险分析 (Cost-Risk Analysis)

保护的总成本不仅仅是修缮费，还包括了**残留风险**。

$$TC = C_{measure} + E[L]_{residual}$$

- $C_{measure}$: 比如“加高防洪堤”或“整体搬迁”的一次性投入。
- $E[L]_{residual}$: 采取措施后，仍然可能发生的预期保险损失（由你们的Problem 1 保险模型计算得出）。通常采取措施后，这个值会降低。

#### 第四步：核心决策公式 (The Preservation Index)

我们将收益与成本进行比对，定义 **保护指数 ($PI$)**：

$$PI = \frac{TV}{TC} = \frac{V_{econ} + \alpha \cdot V_{culture}}{C_{measure} + E[L]_{residual}}$$

------

### 3. 决策判据与资金缺口 (Decision Logic)

这是模型最精彩的部分，它直接指导了“给社区的一封信”怎么写。

**判据 1：是否值得保护？**

- 若 $PI < 1$：**放弃 (Abandon)**。社会总成本过高，即使算上文化价值也不划算。
- 若 $PI \ge 1$：**必须保护 (Preserve)**。

**判据 2：谁来买单？ (若 $PI \ge 1$)**

我们需要比较 **纯商业收益 ($V_{econ}$)** 与 **总成本 ($TC$)**：

- **情形 A (商业可持续):**

  $$V_{econ} \ge TC$$

  **结论：** 市场驱动。保险公司和业主可以自行承担费用，有利可图。无需政府干预。

- **情形 B (市场失灵 - 需要干预):**

  $$V_{econ} < TC$$

  **结论：** 虽然 $PI > 1$ (对社会有益)，但商业上亏本。这就是**“文化遗产保护的困境”**。 此时，需要计算**资金缺口 ($G$)**，即你需要向社区/政府申请的补贴额度：

  $$G = TC - V_{econ} = (C_{measure} + E[L]_{residual}) - V_{econ}$$

  **解释：** 这个 $G$ 值，本质上就是社会为了保留 $\alpha \cdot V_{culture}$ 这一文化价值所必须支付的**“文化溢价”**。

------

### 第五阶段：最终产出——给社区的信

**任务**：把数学变成人话。

- **内容**：基于 Q4 的结果，告诉社区：“虽然保护这个古迹要花 500 万美元修防洪堤，但我们的模型显示它的文化与旅游价值折合现值是 2000 万美元，且未来洪水概率将增加 30%，所以请立刻行动。”







